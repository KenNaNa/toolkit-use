/*!
 * toolkit-use v0.1.3
 * (c) 2023 ~ 至今 kennana
 * Released under the MIT License.
 */
import"core-js/modules/es.json.stringify.js";import"core-js/modules/es.object.keys.js";import"core-js/modules/es.array.filter.js";import"core-js/modules/es.object.to-string.js";import"core-js/modules/es.regexp.to-string.js";import e from"crypto-js";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r=e.enc.Utf8.parse("3333e6e143439161"),o=e.enc.Utf8.parse("e3bbe7e3ba84431a"),n="localStorage",i="SDF_0.0.1",u=1,a=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(""!==t&&null!=t||(t=null),isNaN(r)||r<0)throw new Error("Expire must be a number");r=1e3*(r||u);var o={value:t,time:Date.now(),expire:r},i=l(JSON.stringify(o));window[n].setItem(f(e),i)},s=function(){for(var e=window[n].length,t=new Array,r=0;r<e;r++){var o=window[n].key(r),i=window[n].getItem(o);t[r]={key:o,val:i}}return t},c=function(e){window[n].removeItem(f(e))},f=function(e){return i+"_"+e},g=function(e){var t=i.length+1;return e.substr(t)},l=function(n){if("object"===t(n))try{n=JSON.stringify(n)}catch(e){console.log("encrypt error:",e)}var i=e.enc.Utf8.parse(n);return e.AES.encrypt(i,r,{iv:o,mode:e.mode.CBC,padding:e.pad.Pkcs7}).ciphertext.toString()},p=function(t){var n=e.enc.Hex.parse(t),i=e.enc.Base64.stringify(n),u=e.AES.decrypt(i,r,{iv:o,mode:e.mode.CBC,padding:e.pad.Pkcs7});return u.toString(e.enc.Utf8).toString()},m={isSupportStorage:function(){return"undefined"!=typeof Storage},setStorage:a,getStorage:function(e){if(e=f(e),!window[n].getItem(e)||"null"===JSON.stringify(window[n].getItem(e)))return null;var t=JSON.parse(p(window[n].getItem(e))),r=Date.now();return t.expire&&6e3*u<r-t.time?(c(e),null):(a(g(e),t.value),t.value)},hasStorage:function(e){return e=f(e),!!s().filter((function(t){return t.key===e})).length},getStorageKeys:function(){for(var e=s(),t=[],r=0;r<e.length;r++){var o=e[r].key;t.push(o)}return t},getStorageForIndex:function(e){return window[n].key(e)},getStorageLength:function(){return window[n].length},getStorageAll:s,removeStorage:c,clearStorage:function(){window[n].clear()},autoAddPrefix:f,autoRemovePrefix:g,encrypt:l,decrypt:p};export{m as ToolkitUseStorage};
